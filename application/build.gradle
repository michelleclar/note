plugins {
    id 'java'
    id 'idea'
    id 'io.quarkus'
}
dependencies {
    implementation project(':jooq')
    implementation project(':smtp')
    implementation enforcedPlatform(libs.quarkusPlaform)
    implementation libs.jooq
    implementation libs.bundles.quarkus
    implementation libs.bundles.auth
    implementation libs.quarkusSmallryeOpenapi
    implementation libs.slf4jJbossLogmanager
    implementation libs.dbHealth
    implementation libs.cache
    implementation libs.rest.client.jackson
    implementation libs.rest.client
    implementation libs.smtp
    implementation libs.valid
    implementation libs.grpc
}

def mySrcDir = 'src/main/java'
def generatedDir = 'src/main/generated'
sourceSets {
    main {
        java {
            srcDir generatedDir
            srcDir mySrcDir
        }
    }
}
idea {
    module {
        generatedSourceDirs.addAll(file(generatedDir))
        sourceDirs.addAll(file(generatedDir))
        sourceDirs.addAll(file(mySrcDir))
    }
}

quarkus {
    quarkusBuildProperties.put("quarkus.grpc.codegen.proto-directory", "../protos")
}

test {
    systemProperty 'java.util.logging.manager', 'org.jboss.logmanager.LogManager'
}